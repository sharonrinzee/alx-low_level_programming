Sharon's C- functions, nested loops
